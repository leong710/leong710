# Emily廢資專屬技能說明書_2021-09-17

## ● 操作環境介紹：
>### 公用機使用說明：[目的] 遠端連入操作使用
* 公用機電腦名稱：`hp07110p`
	- 公用帳號：`eshuser`
	- 公用密碼：`&9t040500`

	因為使用本機登入，所以在使用者名稱要填上：`hp07110p\eshuser`

	使用公用帳號是因為Emily有鎖定安裝帳號個人使用。

	自動開關機時間：`每日07:40~22:00`
	- 時間需要調整亦可提出調整需求。


>### 分享資料夾連入：[目的] 放入操作文件檔案
* 公用機分享資料夾：`\\hp07110p\emily$`
	- 本地對應位置：`D:\Emily_workspace`
	- T槽替代捷徑：`T:\82_Emily_workSpace`

	資料夾名稱與結構請勿任意更動，以免影響Emily運行。


>### 桌面常用功能介紹：

* EMILY - **`主程式`**
* 廢棄物申報入口 - **`環保署申報網頁`**
* Emily_workspace-在D槽 - **`捷徑-快速到D槽Emily_workspace`**

---
## ● 技能介紹1-三聯單申請

>### 技能介紹1：申報三聯單

|主|名稱|主技能|子技能|共用技能|
|---|----|:---:|:---:|:---:|
|主技能|委託申報三聯單|1|1|1|
|主技能|再利用申報三聯單|1|1|1|

* 工作資料夾架構 `\\hp07110p\emily$\01廢棄物三聯單\`			
	- \0工作參照\ `*存放Emily操作此技能之資料來源`			
	- \1申請產出\ `*Emily申請完聯單後產出聯單號碼的紀錄檔存放位置`			
	- \1申請產出\備存\ `小幫手彙整完後備存記錄檔的地方`			
	- \3申請紀錄管控表\ `小幫手彙整各廠廢棄物聯單管控表存放位置`			

- ### \0工作參照\

|檔名|說明|時機|
|----|----|---|
|pw.txt|純文字檔，存放登入密碼|登入時取用|
|user.txt|純文字檔，存放登入帳號|登入時取用|
|廢棄物聯單管控表_再利用.xlsx|再利用申請資料，可多筆|對應技能取用|
|廢棄物聯單管控表_委託.xlsx|委託申請資料，可多筆|對應技能取用|

* 帳號/密碼分開填寫，一次只能一組。
* 請勿變動申請管控表之檔名 ==>Emily會抓不到Source
* 請勿變動申請管控表之任何欄位 ==>Emily填資料會錯位或停擺
* 申報內容必須與網頁上的資料一致，不要任意增減內容，會導致網頁找不到對應資料而失敗

				
- ### \1申請產出\

|檔名|說明|時機|
|----|----|---|
|2021-09-07再利用申報廢棄物聯單管控表.csv|emily申請完成後產出記錄檔，內含聯單號碼|小幫手或user取用|
|2021-09-07委託申報廢棄物聯單管控表.csv|emily申請完成後產出記錄檔，內含聯單號碼|小幫手或user取用|

* 無聯單號碼之紀錄表示申報失敗!! 為何失敗則由user自行查明問題。

---
>> ### A操作程序：申報三聯單

1.放入欲申請之管控表				
* 路徑： `\\hp07110p\emily$\01廢棄物三聯單\0工作參照\`
* 檔名： `廢棄物聯單管控表_再利用.xlsx`
	* `廢棄物聯單管控表_委託.xlsx`
	* 兩項管控表不須同時放，因為技能操作是分開進行的。要操作哪一項就放哪一項。				
				
2.放入欲登入之帳號密碼				
* 路徑：`\\hp07110p\emily$\01廢棄物三聯單\0工作參照\`
* 檔名：`pw.txt`
	* `user.txt`
				
3.啟動Emily				
* 路徑：`公用帳號eshuser桌面上`
* 檔名：`EMILY`
				
4.啟動主技能
* 主技能：委託申報三聯單			
* 主技能：再利用申報三聯單			
* 執行技能：找到您要的技能，按下右方`[播放鍵]`即可執行該項技能
				
* 自動處理程序：
	1. Excel轉檔CSV準備導入使用
	2. 開啟網頁填入 帳號/密碼

* 等待填入驗證碼：程式到這裡會暫停等待user
	1. User填入驗證碼			
	2. 點選程式`[完成了]`			
	* 驗證碼填寫完成不要按 `[登入]`!!!! 要按Emily的`[完成了]`
	接下來就讓Emily繼續執行後面行程即可~				

---
>> ### B操作程序	申報三聯單+小幫手

* 路徑：`\\hp07110p\emily$\01廢棄物三聯單\`
* 檔名：`三聯單申報佈署小幫手v1.xlsm`
* 開發工具：`Excel vba`
* 使用前注意事項：
	1. 登出+關閉TrustView			
	2. Excel信任中心 > 巨集設定 > 啟用所有巨集			
* 主要功能：
	1. 將選定的清單匯入指定位置檔案內，省去改名和放置區的問題			
	2. 自動產出 user & pw.txt，省去手動更改的問題			
		* 匯入時會比對清單是否與User一致			
		* 會比對清單申請類別與匯入工作類別是否一致			


#### 1.開單前準備：
* 放置清單：將委託或再利用清單 與小幫手擺在同一個資料夾。
* 路徑：\\hp07110p\emily$\01廢棄物三聯單\

	- Step1. 選取清單：使用右側按鈕選擇對應要申請的清單
	- Step2. 切換使用者：使用下拉選單選取自己廠區
	- Step3. 執行佈署：按下執行佈署即可自動完成相關動作

	- 後續程序：接著`[A操作程序-3.啟動Emily]`節點開始執行到結束即可

#### 2.開單後彙整：
* 開啟三聯單小幫手

	* Step4. 選取彙整清單：使用右側按鈕選擇對應要彙整的清單
	* Step5. 執行彙整：按下執行彙整即可自動完成相關動作(彙整+移到備存)
		- 彙整路徑：`\\hp07110p\emily$\01廢棄物三聯單\3申請紀錄管控表`
		- 備存路徑：`\\hp07110p\emily$\01廢棄物三聯單\1申請產出\備存\`
	* Step6. 一鍵清除佈署：執行`[一鍵清除佈署]`即可自動移除開單前準備所產出的檔案
		- 清除路徑：`\\hp07110p\emily$\01廢棄物三聯單\0工作參照\`
















> 以下是備用語法參照：
***
* * *
- - -

![unsplash 圖片](https://images.unsplash.com/photo-1573900941478-7cc800f708f3?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=2100&q=80)

[Google](https://www.google.com.tw/ 'title')

<http://tw.yahoo.com>

```base
//本文多連結的範例
I get 10 times more traffic from [Google] [1] than from
[Yahoo] [2] or [MSN] [3].

  [1]: http://google.com/        "Google"
  [2]: http://search.yahoo.com/  "Yahoo Search"
  [3]: http://search.msn.com/    "MSN Search"
```
1986\. What a great season.

- [ ] 待辦事項
- [x] 已完成事項
- [ ] 待辦事項
- [x] 已完成事項

	|姓名|性别|年龄|國籍|
	|---|----|----|---|
	|大子|男|94|日本|
	|大子|女|87|美國|
